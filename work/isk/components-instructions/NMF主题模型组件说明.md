## NMF主题模型

### 1. 简介

非负矩阵分解（Non-Negative Matrix）是一种经典的基于矩阵分解的主题模型。该组件以词袋矩阵或TF-IDF矩阵作为输入。

### 2. 参数面板说明

+ 特征列：输入词袋矩阵或者TF-IDF矩阵（可以通过“所有token”一键勾选）。
+ 主题数：模型主题的个数，为正整数，默认为10。
+ 初始化策略：矩阵 $W$ 和 $H$ 的初始化策略。
  + None：若主题数小于样本数，也小于特征列的个数，则采用NNDSVD策略；否则采用Random策略。
  + Random：随机的非负浮点数矩阵，并使用 $ \sqrt{ \frac{均值}{主题数}}$  标准化。
  + NNDSVD：非负双奇异值分解（适合稀疏数据）。
  + NNDSVDA：在NNDSVD的基础上，将0填充为该变量的均值。
  + NNDSVDAR：在NNDSVD的基础上，将0填充为较小的浮点数。
  + Custom：使用定制的 $W$ 和 $H$ 矩阵。
+ 损失类型：度量矩阵分解造成的损失的方法，分为Frobenius、Kullback-Leibler、Itakura-Saito，建议使用前两种。
+ 最小收敛数：模型迭代过程中，作为判别参数收敛的标准，为非负浮点数，默认为0.0001。
+ 最大迭代次数：训练参数过程中，最大迭代次数，默认为10。
+ 随机种子：为了使得每次运行得到相同结果，应设置随机种子，为正整数，默认为42。
+ 正则化强度：所有正则化项前的系数，若设为0则表示不进行正则化。
+ L1正则化系数：NMF模型同时采用L1正则化和L2正则化，该系数应为0-1之间的浮点数。
+ 正则化策略：both表示同时对成分矩阵 $H$ 和转换矩阵 $W$ 进行正则化，component表示只对矩阵 $H$ 进行正则化，transformation表示只对 $W$ 进行正则化，默认为both。

### 3. 输入输出桩说明

+ 输入桩：1个，连接数据对象。
+ 输出桩：3个。左侧输出桩返回已训练的NMF模型，中间输出桩返回包含各样本主题标签的数据对象，右侧输出桩返回原数据对象。

### 4. 节点报告

+ 返回主题成分矩阵（主题在各个token上的载荷）、主题关键词（每个主题选取最有代表性的5个关键词）、分解损失、实际迭代次数。

![](D:\文档\2020-2021-2\文本分析组件\pics\NMFReport.png)

### 5. 原理说明

+ 输入矩阵 $X$ , 非负矩阵分解求解两个非负矩阵 $W$ 和 $H$ ，使得将 $X$ 分解为这两个矩阵的乘积的损失( $ ||X-WH||^2$)尽可能小。

